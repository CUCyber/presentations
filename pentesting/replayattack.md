# Replay Attacks

By: Weston Belk, Nick Bulischeck

CU Cyber


## You Can Find These Presentations Online

Visit [cucyber.net](https://cucyber.net) to find these presentations and more online!



# What is a replay attack?

* Man-in-the-middle attack
	- Someone is sniffing your traffic.
	- Via proxy, arp poisoning, wireshark, or  malware.
* Resubmitting (replaying!) your valid packets.


# How it works

1. Client sends server a packet
2. The server and the hacker receive a copy of the packet
3. The server responds to the client (SUCCESS)
4. The hacker sends the server a copy of the original packet
5. The server responds to the hacker (SUCCESS)


# @todo Add an illustration!!



# What are the dangers?

* Online purchases can be replayed
* Server doesn't know the difference
* Hacker can replay your login
	- Red team is now in your account
	- Compromised user may be blamed



# Preventing Replay Attacks

* Timestamps
* Session logic
* Encryption (SSL)


## Timestamps

* Only allow communication within a certain time of the last communication
* Vulnerable if replay attack is carried out quickly enough


## Session Logic

1. Server sends the client a nonce (number used one)
2. Client send the server: password + hash(session)
3. Server checks: client submission == db_password + hash(session)
4. If they match then the client is authenticated


## Encryption (SSL)

* TLS handshake has some nonce concepts built in
* Vulnerable to web proxies


## Other Methods

* There are more advanced challenge/response algorithms
	- Not standard
	- Easy to screw up
	- Computially expensive
* SRP (@todo do more research)
* I am not a cryptography expert


## Protecting your webapp

* Use session logic
* Use https
* Leave cryptography to the experts.

Note:
Generally session logic and https are enough to stop replay attacks.
As always, when it comes to encryption use a library and don't try to implement it yourself because you probably don't know what you're doing.



# Common Uses

* Undetected nefarious acts
* WEP Wifi cracking (Aircrack-ng)
* [Unlocking your car](https://www.youtube.com/watch?v=Q-OlgVLHIDs)


## Common Tools

* TCPDump/Wireshark
* Web proxies like Burp Suite or Postman
* Ettercap


## Demonstration
