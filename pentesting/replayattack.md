# Replay Attacks

By: Weston Belk, Nick Bulischeck

CU Cyber

---

## You Can Find These Presentations Online

Visit [cucyber.net](https://cucyber.net) to find these presentations and more online!

---

# What is a replay attack?

* Man-in-the-middle attack
	- Someone is sniffing your traffic.
	- Via proxy, arp poisoning, wireshark, or  malware.

Resubmitting (replaying!) your valid packets.

---

# How it works

1. Client sends server a packet
2. The server and the hacker receive a copy of the packet
3. The server responds to the client (SUCCESS)
4. The hacker sends the server a copy of the original packet
5. The server responds to the hacker (SUCCESS)

---

# @todo Add an illustration!!

---

# What are the dangers?

* Online purchases can be replayed
* Server doesn't know the difference
* Hacker can replay your login
	- Red team is now in your account
	- Compromised user may be blamed

---

# Preventing Replay Attacks

* Timestamps
* Session logic
* Encryption (SSL)

---

## Timestamps

---

## Session Logic

Assuming an unencrypted channel.

1. Server sends the client a nonce (number used one)
2. Client send the server: password + hash(session)
3. Server checks: client submission == db_password + hash(session)
4. If they match then the client is authenticated

---

## Encryption (SSL)

* TLS handshake has some nonce concepts built in
* Vulnerable to web proxies

---

## Unencrypted Communications

* aka sending passwords in plaintext
	- (Don't, please.)
* There are more advanced challenge/response algorithms
	- Not standard
	- Easy to screw up
	- Computially expensive
* SRP (@todo do more research)
* I am not a cryptography expert

---

## Protecting your webapp

* Use session logic
* Use https
* Leave cryptography to the experts.

---

# Common Uses

* Undetected nefarious acts
* WEP Wifi cracking (Aircrack-ng)
* [Unlocking your car](https://www.youtube.com/watch?v=Q-OlgVLHIDs)

---

## Common Tools

* TCPDump/Wireshark
* Web proxies like Burp Suite or Postman

## Demonstration
